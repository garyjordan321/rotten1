"use strict";(self.webpackChunkjsBundle=self.webpackChunkjsBundle||[]).push([[162],{9858:function(e,t,r){r.d(t,{A:function(){return c}});var a=r(8168),n=r(6540),s=r(2072),i=r(8710);function c(e,{fetcher:t,scroll:r,showLoader:c=!1,logErrors:l=!1}){class o extends n.Component{constructor(){super(),this.state={data:[],isPending:!0,didError:!1},this.fetchData=this.fetchData.bind(this)}componentDidMount(){r?this.buildObserver():this.fetchData()}buildObserver(){const{element:e,observerOptions:t={}}=r;(0,i.A)({callback:()=>{this.fetchData()},elements:[e],doOnce:!0,observerOptions:t})}fetchData(){return new Promise(function(e,r){var a=function(){try{return e()}catch(e){return r(e)}},n=function(e){try{return l&&console.error(e),this.setState({isPending:!1,didError:!0}),a()}catch(e){return r(e)}}.bind(this);try{let e;return Promise.resolve(t()).then(function(t){try{return e=t,this.setState({data:e,isPending:!1,didError:!1}),a()}catch(e){return n(e)}}.bind(this),n)}catch(e){n(e)}}.bind(this))}render(){const{data:t,isPending:r,didError:i}=this.state;return i||!r&&!t.length?null:c&&r?n.createElement(s.A,null):n.createElement(e,(0,a.A)({dataFetch:{data:t,isPending:r}},this.props))}}return o}},3342:function(e,t,r){var a=r(6540);t.A=({children:e,level:t,id:r,display:{cssClasses:n=[],srOnly:s=!1}={cssClasses:[],srOnly:!1}})=>{const i=n,c="h".concat(t>6||t<1?2:t);return s&&i.push("is-sr-only"),a.createElement(c,{className:i.join(" "),id:r||void 0},e)}},2072:function(e,t,r){var a=r(6540);t.A=({display:{suffix:e}={suffix:"s"}})=>a.createElement("div",{className:"c-loading c-loading--".concat(e," loading loading--").concat(e),"aria-hidden":"true"})},3346:function(e,t,r){function a(e,t=[]){let r="";return t.length&&(r+="fields=".concat(t.join(",")),e.length&&(r+="&")),e.forEach((({name:t,items:a},n)=>{a.forEach((({value:s,include:i},c)=>{r+="".concat(t).concat(i?"=":"!=").concat(s),(n!==e.length-1||c!==a.length-1)&&(r+="&")}))})),r}r.d(t,{A:function(){return a}})},2162:function(e,t,r){r.d(t,{A:function(){return C}});var a=r(6540),n=r(961),s=r(9858),i=r(3346),c=r(161),l=r(6191),o=r(8e3),u=e=>e.map((({mailchimp_interest_id:e,logo:t,description:r,name:a})=>({interestId:e,logoUrl:t,description:r,title:a}))),d=r(4684),m=r(9517),h=r.n(m),p=({register:e,validation:t,errors:r,name:n,label:{text:s,render:i},showLabel:c=!0,placeholder:l=null,testId:u=null})=>{const d=(0,o.A)(1e3),m=["c-sign-up__input","c-text-input__input","l-display-block","l-width-full","has-text-gray-dark","t-size-xs","t-lh-b"];r&&(m.push("is-invalid"),m.push("grid_separator--xs"),m.push("has-xxxs-btm-marg"));const h=i?i():s;return a.createElement("div",{className:"c-text-input"},c&&a.createElement("label",{htmlFor:"".concat(n,"-").concat(d),className:"l-display-block has-xxxs-btm-marg grid_separator--xxxs t-size-s"},a.createElement("strong",null,h)),a.createElement("input",{ref:e(t),id:"".concat(n,"-").concat(d),name:n,placeholder:l,"aria-label":!c&&h,"aria-invalid":!!r,"aria-describedby":"".concat(n,"-errors-").concat(d),"data-testid":u,className:m.join(" "),type:"text"}),a.createElement("ul",{id:"".concat(n,"-errors-").concat(d),"aria-live":"polite","data-testid":"".concat(u,"-errors"),className:"c-sign-up__error has-text-error t-size-xxs"},r&&a.createElement("li",null,r.message)))},g=({value:e="Submit",display:{bgColor:t}={bgColor:"yellow"},testId:r=null})=>{let n;return"yellow"===t?n="black-off":"teal"===t&&(n="white"),a.createElement("input",{value:e,"data-testid":r,"aria-label":e,type:"submit",className:"c-button c-button--s c-sign-up__submit button button--yellow has-text-".concat(n," has-bg-").concat(t," l-width-full l-display-block")})};const b=e=>{const t={};return Object.keys(e).forEach((r=>{t[r]=e[r].value})),t};var f=({initialValues:e,gaLabel:t,description:r,errorMessage:n,isLoading:s,display:{showPromo:i},onSubmit:c})=>{const{register:l,handleSubmit:o,errors:u}=(0,d.mN)({defaultValues:b(e)});return a.createElement("form",{onSubmit:o(c),className:"c-sign-up__main-form l-pos-rel has-padding","data-testid":"main-form",noValidate:!0},s&&a.createElement("div",{className:"c-sign-up__loader","data-testid":"main-form-loader"}),r&&a.createElement("p",{className:"t-lh-b t-size-m has-b-btm-marg","aria-hidden":"true","data-testid":"main-form-desc"},a.createElement("strong",null,r)),a.createElement("div",{className:"c-mini-form ".concat(i?"has-l-btm-marg":"has-xs-btm-marg")},a.createElement("div",{className:"c-mini-form__input"},a.createElement(p,{register:l,validation:{required:"Error: Email is required.",validate:e=>h()(e.trim())||"Error: Enter a valid email to sign up."},errors:u.email,showLabel:!1,label:{text:"signup email"},placeholder:"Your email address",name:"email",testId:"main-form-email"})),a.createElement("div",{className:"c-mini-form__submit"},a.createElement(g,{value:"Sign up",testId:"main-form-submit"}))),a.createElement("div",{className:"c-sign-up__phone"},a.createElement(p,{register:l,validation:{required:!1},errors:u.phone,label:{text:"phone"},name:"phone"})),!n&&i&&a.createElement("p",{className:"t-size-xs"},"Browse all newsletters at"," ",a.createElement("a",{href:"/newsletters/","ga-on":"click","ga-event-category":"subscribe intent","ga-event-action":"signup module link","ga-event-label":t},"texastribune.org/newsletters"),"."),n&&a.createElement("p",{className:"c-sign-up__error has-text-error t-size-xxs","data-testid":"main-form-error"},n))};const y="/api/v1/users/subscribe/",v="/api/v1/newsletters/",E="c1926c28df",w="newsletter-subscribe",_="We're sorry. Your newsletter sign-up didn't go through. If the problem persists, email us at community@texastribune.org for help.";var x=r(9680),S=r(6199),N=({interestId:e,title:t,description:r,payload:n,gaLabel:s,showPromo:i,updatePayload:c,updateSuccessMessage:o})=>{const[u,d]=(0,a.useState)(""),[m,h]=(0,a.useState)(!1);return a.createElement(f,{description:r,gaLabel:s,initialValues:{email:{value:""},phone:{value:""}},isLoading:m,errorMessage:u,display:{showPromo:i},onSubmit:function({email:r,phone:a}){return new Promise((function(i,u){let m,p;h(!0);var g=function(e){try{return h(!1),d(_),i()}catch(e){return u(e)}};try{return Promise.resolve((0,S.A)(x.yF)).then((function(b){try{return m=b,function(){try{var g=function(e){return function(t){try{return h(!1),e&&e.call(this,t)}catch(e){return u(e)}}.bind(this)}.bind(this);p={honeypot:a,email:r.trim(),recaptcha_token:m,recaptcha_action:x.yF};var b=function(){try{return i()}catch(e){return u(e)}},f=function(e){try{return e.response&&e.response.data&&e.response.data.detail?d(e.response.data.detail):d(_),g(b)()}catch(e){return g(u)(e)}};try{let r;return Promise.resolve(l.A.post(y,{...n,...p,interests:{[e]:!0}})).then((function(e){try{return r=e,c(p),window.dataLayer.push({event:"customSubscribeSuccess",gaAction:t.toLowerCase(),gaLabel:s}),r&&r.data&&r.data.detail?o(r.data.detail):o("You've been successfully subscribed!"),g(b)()}catch(e){return f(e)}}),f)}catch(e){f(e)}}catch(e){return u(e)}}()}catch(e){return g()}}),g)}catch(e){g()}}))}})},P=()=>a.createElement("p",{style:{marginTop:"1.1rem"},className:"t-size-xs has-text-gray"},"This site is protected by reCAPTCHA and the Google"," ",a.createElement("a",{href:"https://policies.google.com/privacy"},"Privacy Policy")," and"," ",a.createElement("a",{href:"https://policies.google.com/terms"},"Terms of Service")," apply."),k=({didError:e,didSucceed:t,isLoading:r,mainSuccessMessage:n,showForm:s,onSubmit:i})=>{const c=!e&&!t;return a.createElement("form",{onSubmit:e=>{e.preventDefault(),i()},className:"c-sign-up__secondary-form l-pos-rel has-padding","aria-live":"polite","aria-atomic":"true","data-testid":"secondary-form",noValidate:!0},r&&a.createElement("div",{className:"c-sign-up__loader","data-testid":"secondary-form-loader"}),c&&a.createElement("p",{className:"t-lh-b t-size-m has-b-btm-marg"},a.createElement("strong",null,n)),t&&a.createElement("p",{className:"t-lh-b t-size-m has-b-btm-marg"},a.createElement("strong",null,"Thanks! You're all set.")),e&&a.createElement("p",{className:"t-lh-b t-size-m has-b-btm-marg"},a.createElement("strong",null,"We're sorry. Your newsletter sign-up didn't go through.")),c&&s&&a.createElement("p",{className:"t-size-s has-text-gray-dark has-b-btm-marg"},"While we're here â€¦ would you like to get emails about the latest breaking news?"),e&&a.createElement("p",{className:"t-size-s has-text-error has-b-btm-marg","data-testid":"secondary-form-error"},"This may be because of a slow or interrupted connection. Please try again and, if the issue persists, contact us at community@texastribune.org."),!t&&s&&a.createElement(a.Fragment,null,a.createElement(g,{value:"Sign up for breaking news",testId:"secondary-form-submit"}),a.createElement(P,null)))},A=({payload:e,interestId:t,mainSuccessMessage:r,skipSecondaryForm:n=!1})=>{const[s,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),m=E!==t;return a.createElement(a.Fragment,null,!n&&a.createElement(k,{didError:s,didSucceed:c,isLoading:u,mainSuccessMessage:r,showForm:m,onSubmit:function(){return new Promise((function(t,r){let a;d(!0);var n=function(e){try{return d(!1),i(!0),t()}catch(e){return r(e)}};try{return Promise.resolve((0,S.A)(x.yF)).then((function(s){try{return a=s,function(){try{var n=function(e){return function(t){try{return d(!1),e&&e.call(this,t)}catch(e){return r(e)}}.bind(this)}.bind(this),s=function(){try{return t()}catch(e){return r(e)}},c=function(e){try{return i(!0),o(!1),n(s)()}catch(e){return n(r)(e)}};try{return Promise.resolve(l.A.post(y,{...e,interests:{[E]:!0},recaptcha_token:a,recaptcha_action:x.yF})).then((function(e){try{return i(!1),o(!0),window.dataLayer.push({event:"customSubscribeSuccess",gaAction:"breaking news alerts",gaLabel:"recommendation"}),n(s)()}catch(e){return c()}}),c)}catch(e){c()}}catch(e){return r(e)}}()}catch(e){return n()}}),n)}catch(e){n()}}))}}),n&&a.createElement("p",{style:{alignContent:"center"}},a.createElement("strong",null,r)))},L=r(3633),F=r(3342),I=({dataFetch:e,gaLabel:t,display:{bgColor:r,isVertical:n,headingLevel:s=2,skipSecondaryForm:i=!1,hideImage:c=!1}})=>{const{interestId:l,logoUrl:o,title:u,description:d}=e.data[0],[m,h]=(0,a.useState)({ga_label:t,utm_code:(0,L.A)()}),[p,g]=(0,a.useState)(""),b=["c-sign-up__forms"],f=["c-sign-up","t-links-underlined"],y=!!m.email;return n?f.push("c-sign-up--vert"):f.push("c-sign-up--horiz"),y&&b.push("did-shift"),a.createElement("section",{className:"".concat(f.join(" ")),"data-testid":"sign-up"},d&&a.createElement(F.A,{level:s,display:{srOnly:!0}},d),o&&!c&&a.createElement("div",{className:"c-sign-up__logo",style:{backgroundColor:r},"data-testid":"logo"},a.createElement("img",{src:o,alt:"".concat(u," newsletter"),className:"l-align-center-x"})),a.createElement("div",{className:"c-sign-up__content"},a.createElement("div",{className:"".concat(b.join(" ")),"data-testid":"carousel"},a.createElement(N,{title:u,description:d,interestId:l,payload:m,gaLabel:t,showPromo:!n,updateSuccessMessage:g,updatePayload:e=>{h((t=>({...t,...e})))}}),a.createElement(A,{title:u,payload:m,interestId:l,mainSuccessMessage:p,skipSecondaryForm:i}))))};function z(e){const{authors:t=[],gutenTags:r=[],series:a=[]}=window.ttGlobal,n=(0,i.A)([{name:"author",items:t.map((e=>({include:!0,value:e})))},{name:"tag",items:r.map((e=>({include:!0,value:e})))},{name:"series",items:a.map((e=>({include:!0,value:e})))}]);return()=>new Promise((function(t,r){var a=function(a){try{return t(e)}catch(e){return r(e)}};try{let e,r,s;return Promise.resolve(l.A.get("".concat(v,"?").concat(n))).then((function(n){try{if(({data:{results:e}}=n),!e.length)throw new Error;return r=u(e),s=(0,o.A)(e.length),t([r[s]])}catch(e){return a()}}),a)}catch(e){a()}}))}function C({selectorSuffix:e,logoUrl:t,isAuto:r=!1,interestId:i,title:l,description:o,gaLabel:u,display:d}){const m=[{interestId:i,logoUrl:t,description:o,title:l}],h={isVertical:!1,headingLevel:2,...d},p=(0,c.A)("#".concat(w,"-").concat(e));if(r){const e=(0,s.A)(I,{fetcher:z(m),scroll:{element:p},showLoader:!0}),t=a.createElement(e,{gaLabel:u,display:h});return x.PP?t:(0,n.render)(t,p)}const g=a.createElement(I,{dataFetch:{data:m},gaLabel:u,display:h});return x.PP?g:(0,n.render)(g,p)}}}]);
//# sourceMappingURL=162.f726a48511ea9294d297.js.map