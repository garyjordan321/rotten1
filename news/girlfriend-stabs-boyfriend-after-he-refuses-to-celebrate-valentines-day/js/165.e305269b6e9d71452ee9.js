"use strict";(self.webpackChunkjsBundle=self.webpackChunkjsBundle||[]).push([[165],{1087:function(e,t,r){r.d(t,{A:function(){return o}});var n,a=r(6540),c=r(8710);function o({element:e,fetchData:t,observerOptions:r}){const[{data:o,isPending:i,didError:s,errorMsg:l},u]=(0,a.useReducer)(((e,t)=>{switch(t.type){case n.SetPending:return{...e,isPending:!0,didError:!1,errorMsg:null};case n.SetData:return{...e,isPending:!1,didError:!1,data:t.data,errorMsg:null};case n.SetError:return{...e,isPending:!1,didError:!0,errorMsg:t.errorMsg};default:return e}}),{data:null,isPending:!0,didError:!1,errorMsg:null}),d=(0,a.useRef)(null),m=(0,a.useRef)(t),h=(0,a.useRef)(!0),f=(0,a.useCallback)((()=>{u({type:n.SetPending}),m.current().then((e=>{h.current&&u({type:n.SetData,data:e})})).catch((e=>{h.current&&u({type:n.SetError,errorMsg:e})}))}),[]);return(0,a.useEffect)((()=>{m.current=t})),(0,a.useEffect)((()=>()=>{h.current=!1}),[]),(0,a.useEffect)((()=>{d.current||(d.current=(0,c.A)({callback:f,doOnce:!0,elements:[e],observerOptions:r}))})),{data:o,isEmpty:!(!Array.isArray(o)||o.length),isPending:i,didError:s,errorMsg:l}}!function(e){e.SetPending="SET_IS_PENDING",e.SetData="SET_DATA",e.SetError="SET_ERROR"}(n||(n={}))},3717:function(e,t,r){var n=r(6540),a=r(4388);t.A=({caption:e,credit:t})=>n.createElement("figcaption",{className:"c-caption has-text-gray-dark l-display-block t-size-xs t-links-underlined"},e," ",t&&n.createElement("cite",null,n.createElement(a.A,{iconName:"camera",display:{baseline:!0}})," ",t))},4388:function(e,t,r){var n=r(6540);t.A=({iconName:e,display:{color:t="",extraClasses:r=[],srHidden:a=!0,baseline:c=!1}={color:"",extraClasses:[],srHidden:!0,baseline:!1}})=>{const o=["c-icon"];return t&&o.push("has-text-".concat(t)),c&&o.push("c-icon--baseline"),r.forEach((e=>{o.push(e)})),n.createElement("span",{className:o.join(" ")},n.createElement("svg",{"aria-hidden":a},n.createElement("use",{xlinkHref:"#".concat(e)})))}},9832:function(e,t,r){var n=r(6540),a=r(3717);t.A=({sources:e,credit:t,description:r,display:{showCaption:c=!1}={showCaption:!1}})=>{const o=["c-image__img"],[i,s]=(0,n.useState)(0),[l,u]=(0,n.useState)(!1),d=(0,n.useRef)(null),m=(0,n.useMemo)((()=>e.map((({url:e,width:t})=>"".concat(e," ").concat(t,"w"))).join(",")),[e]),h=(0,n.useMemo)((()=>i?function(e,t){let r="";return e.sort(((e,t)=>{const r=e.width,n=t.width;return r>n?1:r<n?-1:0})).forEach((({width:e,url:n})=>{e>t&&!r&&(r=n)})),r}(e,i):""),[e,i]);return(0,n.useEffect)((()=>{u(!1),d.current&&s(d.current.offsetWidth)}),[e]),l&&o.push("did-load"),n.createElement("figure",{className:"c-image"},n.createElement("div",{ref:d,className:"c-image__placeholder has-bg-gray-light"},h&&n.createElement("img",{src:h,alt:r,sizes:"".concat(i,"px"),srcSet:m,onLoad:function(){u(!0)},className:o.join(" ")})),c&&t&&n.createElement(a.A,{credit:t,caption:r}))}},7729:function(e,t,r){var n=r(6540);t.A=({action:e,category:t,children:r,href:a,label:c,noTab:o=!1})=>n.createElement("a",{"ga-on":"click","ga-event-action":e,"ga-event-category":t,"ga-event-label":c,href:a,tabIndex:o?-1:void 0},r)},9165:function(e,t,r){r.r(t),r.d(t,{addTextBalance:function(){return a.Z4},buildAdUnit:function(){return a.K6},buildArticleRecs:function(){return R},buildAudio:function(){return H},buildCopyLink:function(){return a.Ee},buildLazyImages:function(){return a.hL},buildRug:function(){return d},buildSeriesLatest:function(){return l},buildSignUp:function(){return c.A},buildVideo:function(){return W},fireEntryDispatches:function(){return a.Db},initPrompt:function(){return a.Lv},makeVidsResponsive:function(){return a.Pv},redirectAfterLogIn:function(){return a.kI},redirectAfterLogOut:function(){return a.hp},shouldShowPromo:function(){return B},showBackToTop:function(){return a.l2}});var n=r(9306),a=r(7526),c=r(2162),o=r(8710),i=r(161),s=r(3020);function l(e){const t=(0,i.A)("#".concat(s.o));(0,o.A)({callback:()=>new Promise((function(t,n){let a;return Promise.resolve(r.e(331).then(r.bind(r,7871))).then((function(r){try{return a=r,a.default(e),t()}catch(e){return n(e)}}),n)})),elements:[t],doOnce:!0,observerOptions:{rootMargin:"".concat(window.innerHeight,"px")}})}var u=r(7205);function d(e){const t=(0,i.A)("#".concat(u.o));(0,o.A)({callback:()=>new Promise((function(t,n){let a;return Promise.resolve(r.e(360).then(r.bind(r,4055))).then((function(r){try{return a=r,a.default(e),t()}catch(e){return n(e)}}),n)})),elements:[t],doOnce:!0,observerOptions:{rootMargin:"".concat(window.innerHeight,"px")}})}var m=r(6540),h=r(961),f=r(9832),p=r(9370),g=r(7729),b=({pubDate:e,updatedDate:t})=>m.createElement("p",{className:"t-byline t-uppercase t-lsp-b t-sans t-size-xs has-text-gray-dark is-hidden-until-bp-m"},m.createElement("time",{className:"t-byline__item l-display-ib",dateTime:e},t?"Updated: ".concat(t):e));const y="Error fetching from LNL API",E="Error fetching from Texas Tribune Articles API",w="read more",v="lnl-recommendation",k="story page";var A=({headline:e,pubDate:t,updatedDate:r,url:n,sitewideImage:a})=>{const c=(0,p.A)(a);return m.createElement("li",{className:"has-b-btm-marg"},m.createElement("article",{className:"c-story-block c-story-block--read-more c-story-block--stack-until-bp-m"},m.createElement("header",{className:"c-story-block__text t-links-underlined-hover"},m.createElement("h3",{className:"has-tiny-btm-marg t-serif"},m.createElement(g.A,{href:n,category:w,action:v,label:k}," ",m.createElement("strong",null,e))),m.createElement(b,{pubDate:t,updatedDate:r})),m.createElement("figure",{className:"c-story-block__image-wrap is-hidden-until-bp-m"},m.createElement(g.A,{href:n,category:w,action:v,label:k},m.createElement(f.A,{description:"Thumbnail for story block",sources:c.thumbs})))))},P=r(1087),x=function(e){return new Set(e).size!==e.length},_=r(9680),N=function(e,{recCount:t=10}={}){return new Promise((function(r,n){let a,c;if(t>10){let e;return e="Requested ".concat(t," articles, but API allows a max of 10."),n(new Error(e))}return Promise.resolve(((e,t)=>new Promise((function(r,n){let a,c,o,i,s,l;return a=((e,{recCount:t}={})=>{const r="&source_entity_id=".concat(e),n=t?"&size=".concat(t):"";return"".concat("https://article-rec-api.localnewslab.io","/recs?").concat("site=texas-tribune&model_type=article&sort_by=score").concat(n).concat(r)})(e,{recCount:t}),Promise.resolve(fetch(a)).then((function(e){try{if(c=e,!c.ok){let e;return e="".concat(y,": ").concat(c.status),n(new Error(e))}return Promise.resolve(c.json()).then((function(e){try{if(o=e,!o.results||!o.results.length){let e;return e="".concat(y,": no results returned"),n(new Error(e))}if(i=o.results.map((e=>e.recommended_article.external_id)),x(i)){let e;return e="".concat(y,": duplicate IDs returned"),n(new Error(e))}return s=t||o.results.length,l=t?i.slice(0,s):i,r(l)}catch(e){return n(e)}}),n)}catch(e){return n(e)}}),n)})))(e,t)).then((function(e){try{return a=e,Promise.resolve((t=a,new Promise((function(e,r){let n,a,c,o;return x(t)?r(new Error("targetIds contains duplicate IDs")):(n=t.map((e=>"id=".concat(e))).join("&"),a="https://www.texastribune.org".concat(_.J$,"?").concat(n,"&fields=").concat(_.T4),Promise.resolve(fetch(a)).then((function(n){try{if(c=n,!c.ok){let e;return e="".concat(E,": ").concat(c.status),r(new Error(e))}return Promise.resolve(c.json()).then((function(n){try{if(o=n,!o.results||!o.results.length){let e;return e="".concat(E,": no results returned"),r(new Error(e))}if(o.results.length!==t.length){let e;return e="".concat(E,": unexpected number of results returned"),r(new Error(e))}return e(o.results)}catch(e){return r(e)}}),r)}catch(e){return r(e)}}),r))})))).then((function(e){try{return c=e,r(c)}catch(e){return n(e)}}),n)}catch(e){return n(e)}var t}),n)}))},S=({children:e})=>m.createElement("section",{className:"t-serif"},m.createElement("div",{className:"has-notch has-bg-yellow has-b-btm-marg","aria-hidden":"true"}),m.createElement("h2",{className:"t-sans t-uppercase t-lsp-b t-size-b has-b-btm-marg has-text-black"},"Read More"),m.createElement("ul",{className:"has-l-btm-marg"},e)),D=r(3516),C=({height:e="16px",width:t="100%",style:r,className:n})=>m.createElement(D.Ay,{height:e,width:t,style:r,className:n,preserveAspectRatio:"none",animate:!1,backgroundColor:"#d0d0d0",foregroundColor:"#d0d0d0",title:"Loading indicator"},m.createElement("rect",{x:"0",y:"0",rx:"5",ry:"5",width:"100%",height:"100%"})),I=()=>m.createElement("li",{className:"has-b-btm-marg"},m.createElement("article",{className:"c-story-block c-story-block--read-more c-story-block--stack-until-bp-m"},m.createElement("header",{className:"c-story-block__text"},m.createElement(C,{style:{marginBottom:"7px"}}),m.createElement(C,{style:{marginBottom:"7px"}}),m.createElement(C,{height:"12px",width:"100px",style:{maxWidth:"100%"},className:"is-hidden-until-bp-m"})),m.createElement("figure",{className:"c-story-block__image-wrap is-hidden-until-bp-m"},m.createElement("div",{className:"c-image__placeholder has-bg-gray-light"})))),L=({articles:e=1})=>m.createElement(S,null,m.createElement("li",{className:"is-sr-only"},"Loading recommendations for further reading"),Array.from({length:e}).map(((e,t)=>m.createElement(I,{key:t})))),O=({scrollTarget:e,articleId:t,recCount:r})=>{const{data:n,isEmpty:a,isPending:c,didError:o}=(0,P.A)({element:e,fetchData:()=>N(t,{recCount:r}),observerOptions:{rootMargin:"500px"}});return o||a?null:c?m.createElement(L,{articles:r}):n&&m.createElement(S,null,n.map((({id:e,headline:t,ap_pub_date:r,ap_updated_date:n,url:a,sitewide_image:c})=>m.createElement(A,{key:e,headline:t,pubDate:r,updatedDate:n,url:a,sitewideImage:c}))))},R=function({selectorSuffix:e,articleId:t,recCount:r=10}){const n="#article-recs-".concat(e),a=(0,i.A)(n);if(null===a)throw new Error("Couldn't find element with selector ".concat(n));const c=m.createElement(O,{articleId:t,recCount:r,scrollTarget:a});return(0,h.render)(c,a)},T=r(7705);const M="tt_promo";function q(){return document.cookie.split(";").map((e=>e.trim()))}function j(e,t){return t.find((t=>t.startsWith("".concat(e,"="))))}function U(e){const t=e.split("=")[1];return JSON.parse(t)}function V(e){const t=JSON.stringify(e),r=(0,T.addDays)(new Date,365).toUTCString();document.cookie="".concat(M,"=").concat(t,"; expires=").concat(r,"; path=/;")}function z(e){return!(!e||"object"!=typeof e)&&["articlesLastAccessed","articlesViewed","promoClosed","hasSignedUp"].every((t=>!!Object.prototype.hasOwnProperty.call(e,t)))}function B(){let e;try{e=function(){const e=q(),t=j(M,e);if(!t)throw new Error("Couldn't find promo cookie in client's cookies");const r=U(t);if(!z(r))throw new Error("Promo cookie data is malformed");return r}()}catch(e){return console.warn("Failed to execute shouldShowPromo",e),!1}const{hasSignedUp:t,promoClosed:r}=e;if(t)return!1;const n=(0,T.subDays)(new Date,7);return!(r&&new Date(r)>n)}function H(e){return new Promise((function(t,n){let a;return Promise.resolve(Promise.all([r.e(798),r.e(644)]).then(r.bind(r,8911))).then((function(r){try{return a=r,a.default(e),t()}catch(e){return n(e)}}),n)}))}function W(e){return new Promise((function(t,n){let a;return Promise.resolve(r.e(843).then(r.bind(r,7919))).then((function(r){try{return a=r,a.default(e),t()}catch(e){return n(e)}}),n)}))}(0,a.Db)(),(0,n.ce)(),function(){const e=q(),t=j(M,e),r=new Date,n={articlesLastAccessed:r.toISOString(),articlesViewed:1,promoClosed:null,hasSignedUp:!1};if(!t)return void V(n);let a;try{a=U(t)}catch(e){return void V(n)}if(!z(a))return void V(n);const c=new Date(a.articlesLastAccessed);(0,T.differenceInDays)(r,c)>30?a.articlesViewed=1:a.articlesViewed+=1,a.articlesLastAccessed=r.toISOString(),V(a)}()},9370:function(e,t){t.A=({thumbnails:e,description:t,credit:r})=>{const n=[{ratio:"normal",width:3e3,quality:75,url:""},{ratio:"normal",width:2500,quality:75,url:""},{ratio:"normal",width:2200,quality:75,url:""},{ratio:"normal",width:1550,quality:75,url:""},{ratio:"normal",width:1200,quality:75,url:""},{ratio:"normal",width:1e3,quality:75,url:""},{ratio:"normal",width:850,quality:75,url:""},{ratio:"normal",width:640,quality:75,url:""},{ratio:"normal",width:375,quality:75,url:""}],a={thumbs:n};return n.forEach((({width:t,ratio:r,quality:n},c)=>{const o="".concat(t,"_").concat(r,"_").concat(n);a.thumbs[c].url=e[o]})),t&&(a.description=t),r&&(a.credit=r),a}},7205:function(e,t,r){r.d(t,{W:function(){return a},o:function(){return n}});const n="rug";let a;!function(e){e.UpcomingEvents="UpcomingEvents",e.LatestVideos="LatestVideos",e.Random="Random"}(a||(a={}))},3020:function(e,t,r){r.d(t,{o:function(){return n}});const n="series-latest"}}]);
//# sourceMappingURL=165.e305269b6e9d71452ee9.js.map